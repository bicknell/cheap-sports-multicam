# cheap-sports-multicam

I wanted a fast, easy way to get multiple camera angles of a soccer game.  The
answer was a combination of hardware and the software in this repository.  While
this documents my specific setup, it would be easy to adapt for other tripods and
cameras.

## Design Parameters:

- 4 cheap action cameras that can hopefully get two angles of most action.
- Record in 1080P, ideally 60fps.
- Output in 4K, a 4x4 tiled screen of all 4 cameras.
- Minimal effort to turn around a video after a game, I don't want to spend
  hours editing and I want it to get out quickly.

## Physical Parts

- 4 [Akaso Brave 7 LE](https://www.akasotech.com/support/Brave-7-LE) action cameras.
  These are often on sale on Amazon, and I bought mine bundled with 128G SD cards.
  They have sufficient battery life to record an entire full length soccer game with
  margin.  They are also water resistant, and so can be used without an enclosure in
  most conditions.
  - The parts are built around a "GoPro" style mount, so pretty much any action cam
    should work.
  - WARNING: Akaso has sold two very different cameras under the same name of 
    "Akaso Brave 7 LE", and externally they look identical.  The newer model has vastly 
    internals and software.  All my instructions are for the newer model, running
    Firmware 1.3, and listed as manual "580+386\_V1.0" on Akaso's web site.
- 2 [Neewer 4M Light Stands](https://www.amazon.com/dp/B0BTL5XYN6), which were one
  of the more affordable ways to get the cameras up in the air.  Getting the cameras
  up makes a HUGE difference.
- 2 [Mordx Canopy Weights](https://www.amazon.com/dp/B0CZ6JP45B), sandbags to steady
  the light stands in the wind.  They do not need to be full, I use 4 lbs in each
  compartment, 8 pounds per tripod leg.  6 can be filled from a 50lb bag.
- 2 sets of 
  [Neewer 4M Light Stands Dual "GoPro" Mount](https://www.printables.com/model/1387522-neewer-4m-light-stands-dual-gopro-mount)
  brackets.  Designed by me, these allow mounting 2 cameras to a single 4M (13 feet)
  tall tripod.  It is essential to get the cameras up in the air.
- 4 [Akaso Brave 7 LE "GoPro" Mount](https://www.printables.com/model/1387497-akaso-brave-7-le-gopro-mount) 
  brackets - optional.  Designed by me, these allow using the cameras without the 
  plastic box, which in turn allows the microphones to be functional.  Easy to 
  3D FDM print in PETG.
- Coming soon! A carry box on Printables.

## Software

In this repository is a script that will generate the necessary ffmpeg command line
to generate the output video from the input video.  It requires Python 3.x, and
pyyaml.

The software will read most video files as input.  The default output options are
H265 for a smaller file.  There is a preset in the code for "YouTube" output which
is an H264 file optimized for YouTube.

An up to date copy of [ffmpeg](https://ffmpeg.org) is required to execute the 
command line generated by the script.

## Camera Quirks

The [camera-quriks.md](camera-quirks.md) file documents known quirks of the cameras
that may need workarounds to produce acceptable results.

## My Workflow

Record the game.  I have notes below for recording a full sized soccer field.

Create a directory referenced as `GAMEDIR` for the rest of this document.  Create 4
subdirectories under `GAMEDIR` called `camera1`, `camera2`, `camera3`, and `camera4`.
Copy the footage from each camera to each directory.  They will be tiled like this:

```
camera1 camera2 
camera3 camera4
```

Open the first file of cameras 1 and 2 in a playback program which can display frame
numbers.  QuickTime player and VLC both work.  Find a moment in view of both cameras
to use for synchronization.  I like to use the moment a ball hits the ground.  The 
frame number from the first camera is `f1`, and from the second `f2`.

Repeat for cameras 2 and 3 (`f3`, `f4`), and then 3 and 4 (`f5`, `f6`).

If you want to add metadata, create a file called `GAMEDIR/metadata.yaml`.  Each
line should be a string to string mapping of a value in the
[Public Metadata API](https://ffmpeg.org/doxygen/7.0/group__metadata__api.html)
to a string.  See metadata.yaml.example in this repository.

Run generate-ffmpeg.py:

```
generate-ffmpeg.py /Path/to/GAMEDIR f1 f2 f3 f4 f5 f6
```

A command line will be generated to stdout.  Inspect it to be sure it does what you
want, then cut and paste into a bash shell terminal.  ffmpeg will run and build
the video as GAMEDIR/final\_video.mp4

WARNING: These video files are extremely large.  Expect a 90 minute soccer game to be
         around 5G per camera, or 20G of total video.  The resulting output file of them
         tiled together will be 10-14G.  Even on a fast box processing may take 2x-4x realtime.

See [DigitalOceanVideo](DigitalOceanVideo/) for a workflow to store the files in a Digital
Ocean Space and process them on a Digitial Ocean Droplet.

## Soccer Specifc Notes

How I record a soccer game.

- Set one camera at an angle of 0, and the other camera at an angle of 55 degrees.
- Visualize where the extended 18 yard box line would hit the sideline.  Walk 3 paces
  down the side line towards the center of the field, then turn and walk 5 paces away
  from the field.  Set up the tripod.
- I use a 16 degree downward tilt on the cameras, measured with my phone.
- On the Brave 7 LE, I configure as follows:
   - Swipe Down, Swipe Left, Gear Icon
      - Reset, if necessary.
      - Format, if necessary.
      - Video Encoding: H.265
      - General Settings:
         - Turn off auto-shutdown.
         - Date Stamp: On
   - Swipe Up
      - Resolution: 1080P
      - Frame Rate: 30
      - Mode: Loop Mode, 5 Minutes per file
   - Swipe Left
      - "Auto"
      - EV: -1.0
   - Turn on Wifi (tap power button) and connect with the phone app, this syncs the 
     time from the phone to the camera, turn off WiFi.
   - Set the zoom to 1.8.
      - Zooms up to 2.5 work good on the camera facing the center, but more zoom
        starts to cut off parts of the sideline.
- Start the cameras and raise the tripod to full height.  Align the 0 degree camera to
  look straight across the field.  The 55 degree camera should be looking roughly
  towards the center of the field.
- Repeat on the opposite end of the field.

